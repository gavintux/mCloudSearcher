function generateObsidianIndex_v4_AutoUpdate() {
  // =========================================================
  // 1. è¨­å®šå€ï¼šè«‹å¡«å…¥æ‚¨çš„ Folder ID (ç¶²å€æˆ– ID çš†å¯)å‹™å¿…è¦è¼¸å…¥æ­£ç¢ºçš„ID 
  var inputId = "Folder ID"; 
  
  // 2. è¨­å®šï¼šå›ºå®šæª”å (ä½ å¯ä¾éœ€æ±‚å–æª”å)
  var fixedFileName = "Drive_Index_gavin49.md";
  // =========================================================

  try {
    var folderId = extractId(inputId);
    var folder = DriveApp.getFolderById(folderId);
    
    // å»ºç«‹æª”æ¡ˆå…§å®¹ (Header)
    var updateTime = new Date();
    // æ ¼å¼åŒ–æ™‚é–“ç‚º YYYY-MM-DD HH:mm
    var timeString = Utilities.formatDate(updateTime, Session.getScriptTimeZone(), "yyyy-MM-dd HH:mm");
    
    var mdContent = "# Google Drive æª”æ¡ˆç´¢å¼• (è‡ªå‹•æ›´æ–°)\n";
    mdContent += "> ğŸ”„ æœ€å¾ŒåŒæ­¥æ™‚é–“ï¼š" + timeString + "\n\n";

    // é–‹å§‹æƒæ
    console.log("æ­£åœ¨æƒæè³‡æ–™å¤¾...");
    processFolder(folder, "");
    
    // é—œéµé‚è¼¯ï¼šæª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
    var files = folder.getFilesByName(fixedFileName);
    if (files.hasNext()) {
      // å¦‚æœæª”æ¡ˆå­˜åœ¨ï¼Œç›´æ¥è¦†è“‹å…§å®¹ (æ›´æ–°)
      var file = files.next();
      file.setContent(mdContent);
      console.log("âœ… ç´¢å¼•æª”å·²æ›´æ–° (è¦†è“‹)ï¼š" + fixedFileName);
    } else {
      // å¦‚æœæª”æ¡ˆä¸å­˜åœ¨ï¼Œå»ºç«‹æ–°æª”æ¡ˆ
      folder.createFile(fixedFileName, mdContent);
      console.log("âœ… æ–°ç´¢å¼•æª”å·²å»ºç«‹ï¼š" + fixedFileName);
    }

  } catch (e) {
    console.error("âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š" + e.toString());
  }

  // --- å…§éƒ¨å·¥å…·å‡½å¼ ---

  function processFolder(currentFolder, parentPath) {
    // è·¯å¾‘è™•ç†
    var currentPath = parentPath ? parentPath + "/" + currentFolder.getName() : currentFolder.getName();
    
    var files = currentFolder.getFiles();
    var subfolders = currentFolder.getFolders();
    
    while (files.hasNext()) {
      var file = files.next();
      // æ’é™¤ç´¢å¼•æª”è‡ªå·±ï¼Œé¿å…è¿´åœˆ
      if (file.getName() === fixedFileName) continue;

      mdContent += "---\n";
      mdContent += "file_name: " + file.getName() + "\n";
      mdContent += "url: " + file.getUrl() + "\n";
      mdContent += "path: " + currentPath + "\n";
      mdContent += "---\n\n"; // ç¢ºä¿æœ‰ç©ºè¡Œ
    }
    
    while (subfolders.hasNext()) {
      processFolder(subfolders.next(), currentPath);
    }
  }

  function extractId(str) {
    str = str.trim();
    if (str.indexOf("folders/") !== -1) {
      return str.split("folders/")[1].split("?")[0].split("/")[0];
    }
    return str;
  }
}